<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA23204171" />

<meta name="date" content="2023-12-08" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">SA23204171</h4>
<h4 class="date">2023-12-08</h4>



<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Go through “R for Beginners” if you are not familiar with R
programming.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p>Sure.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div id="example-1" class="section level3">
<h3>example 1</h3>
<ul>
<li>Latex</li>
</ul>
<p><span class="math display">\[\hat{B}_{k,k&#39;} = \begin{cases}
\frac{\sum_{i \in \mathcal{N}_{1,k}, \, j \in \mathcal{N}_{1,k&#39;}
\cup \mathcal{N}_{2,k&#39;}}A_{ij}}{n_{1,k}(n_{1,k&#39;}+n_{2,k&#39;})},
&amp; k \neq k&#39;,\\
\frac{\sum_{i,j \in \mathcal{N}_{1,k}, \, i&lt;j}A_{ij}+\sum_{i \in
\mathcal{N}_{1,k}, \, j \in
\mathcal{N}_{2,k}}A_{ij}}{(n_{1,k}-1)n_{1,k}/2+n_{1,k}n_{2,k}}, &amp;
k=k&#39;.
\end{cases}\]</span></p>
</div>
<div id="example-2" class="section level3">
<h3>example 2</h3>
<p>This is the first 4 rows for the dataset iris:</p>
</div>
<div id="example-3" class="section level3">
<h3>example 3</h3>
<p>Here I try to change the color of the text and insert a link of a <a href="https://www.bilibili.com/">webpage</a>. I also insert 3 code
chunks of R language, which respectively show and execute the code, show
the code without executing it, and execute the code without showing
it</p>
<div id="show-and-execute-the-code" class="section level4">
<h4>show and execute the code</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">+</span>y)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
<div id="show-the-code-without-executing-it" class="section level4">
<h4>show the code without executing it</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">+</span>y)</span></code></pre></div>
</div>
<div id="execute-the-code-without-showing-it" class="section level4">
<h4>execute the code without showing it</h4>
<pre><code>## [1] 3</code></pre>
</div>
</div>
</div>
<div id="section" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Use the inverse transform method to implement the functions of
‘sample()’ when <span class="math inline">\(replace = T\)</span>.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>my.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n, <span class="at">prob =</span> <span class="cn">NULL</span>){</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="do">### 给定一有限总体，有放回地从中抽取样本</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="co">#   x: 输入一个有限总体，为向量形式</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="co">#   n: 从x中产生的随机数个数，为一正整数</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="co">#   prob: 与x等长的向量，表示x中对应位次元素的入样概率，未指</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="co">#定则默认等概率抽取</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(prob)){</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    <span class="co"># 未指定prob，默认等概率抽取</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)<span class="sc">/</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x))</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(p)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U, cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  } <span class="cf">else</span>{</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="co"># 用户指定了各元素入样概率</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>      <span class="cf">if</span>((<span class="fu">length</span>(prob) <span class="sc">!=</span> <span class="fu">length</span>(x)) <span class="sc">|</span> (<span class="fu">sum</span>(prob) <span class="sc">!=</span> <span class="dv">1</span>)){</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>      <span class="co"># 用户指定的prob格式错误，则返回报错信息</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>      <span class="fu">return</span>(<span class="st">&quot;Wrong entry of the argument &#39;prob&#39;!&quot;</span>)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>      U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>      r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U, p)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    }</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>  }</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>  </span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>  <span class="fu">return</span>(r) <span class="co"># 返回抽样结果，为一向量</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>}</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co"># tests</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>) <span class="co"># 错误指定prob</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>) <span class="co"># 错误指定prob</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="fu">my.sample</span>(x, n, p1)</span></code></pre></div>
<pre><code>##  [1] 10  2  2  4 10  4  2 10 10 10</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">my.sample</span>(x, n, p2)</span></code></pre></div>
<pre><code>## [1] &quot;Wrong entry of the argument &#39;prob&#39;!&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">my.sample</span>(x, n, p3)</span></code></pre></div>
<pre><code>## [1] &quot;Wrong entry of the argument &#39;prob&#39;!&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># comparison with &#39;sample()&#39;</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">/</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1, N, <span class="at">prob =</span> pr, <span class="at">replace =</span> T)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(x1, N, <span class="at">prob =</span> pr)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N), <span class="fu">rep</span>(<span class="dv">1</span>, N)), <span class="fu">c</span>(res1, res2))</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">barplot</span>(counts, </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;my.sample() vs sample()&quot;</span>, </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>        <span class="at">beside=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, </span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>), </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>), </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;sample&#39;</span>, <span class="st">&#39;my.sample&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>3.2 The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2}e^{-\vert x \vert},\, x \in
\mathbb{R}\)</span>. Use the inverse transform method to generate a
random sample of size 1000 from this distribution. Use one of the
methods shown in this chapter to compare the generated sample to the
target distribution.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>由标准Laplace分布的密度函数容易求得其累积分布函数为<span class="math display">\[F(x) = \begin{cases} \frac 12 e^x, &amp; x \le 0
\\ 1-\frac12 e^{-x}, &amp; x &gt; 0 \end{cases}\]</span>注意到<span class="math inline">\(F(x)\)</span>在<span class="math inline">\(\mathbb{R}\)</span>上严格单调递增，因此容易求得其反函数为<span class="math display">\[F^{-1}(x) = \begin{cases} \text{log}(2x), &amp; x
\in (0, \frac12] \\ -\text{log}(2-2x), &amp; x \in (\frac12, 1)
\end{cases}\]</span>因此由逆变换法根据标准Laplace分布生成1000个随机数的算法如下：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u <span class="sc">&lt;=</span> <span class="fl">0.5</span>, <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u), <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># 对生成的随机数做直方图</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">hist</span>(x, </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>     <span class="at">freq =</span> F, </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># 叠加标准Laplace分布的密度曲线</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)), </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">to =</span> <span class="dv">10</span>, </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>      <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Write a function to generate a random sample of size n from the <span class="math inline">\(Beta(a, b)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> density superimposed.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p><span class="math inline">\(Beta(a,
b)\)</span>分布的概率密度函数为<span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1},
\quad 0&lt;x&lt;1\]</span>求导得<span class="math display">\[f&#39;(x) =
\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\cdot[(a-1)x^{a-2}(1-x)^{b-1} -
(b-1)x^{a-1}(1-x)^{b-2}]\]</span>令<span class="math inline">\(f&#39;(x)=0\)</span>求得<span class="math inline">\(f(x)\)</span>的极大值点为<span class="math display">\[x_0=\frac{a-1}{a+b-2}\]</span>带入有<span class="math inline">\(f(x)\)</span>的极大值为<span class="math display">\[f(x_0)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\cdot(\frac{a-1}{a+b-2})^{a-1}(\frac{b-1}{a+b-2})^{b-1}\]</span>因此在接受-拒绝算法中，包络分布可取<span class="math inline">\(Uniform(0, 1)\)</span>，即<span class="math inline">\(g(x) = 1, \, c = f(x_0)\)</span>，使得<span class="math display">\[\rho(x)=\frac{f(x)}{cg(x)}=\frac{(a+b-2)^{a+b-2}x^{a-1}(1-x)^{b-1}}{(a-1)^{a-1}(b-1)^{b-1}}
\le 1.\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># generation function</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>my.rbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, size){</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> size</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co"># 生成的随机序列储存在向量result中</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 计数变量，一旦大于n则退出whlie循环</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="co"># rho()函数</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  rho <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> (a<span class="sc">+</span>b<span class="dv">-2</span>)<span class="sc">^</span>(a<span class="sc">+</span>b<span class="dv">-2</span>) <span class="sc">*</span> x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (b<span class="dv">-1</span>)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    <span class="fu">return</span>(m1<span class="sc">/</span>m2)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  }</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  </span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  <span class="cf">while</span>(flag <span class="sc">&lt;=</span> n){</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># 生成一个U(0, 1)上的随机数</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># 生成来自包络分布的一个随机数</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>    <span class="cf">if</span>(u <span class="sc">&lt;=</span> <span class="fu">rho</span>(y)){</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>      result[flag] <span class="ot">&lt;-</span> y</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>      flag <span class="ot">&lt;-</span> flag <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>    }</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  }</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>  </span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>}</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co"># tests</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">my.rbeta</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1000</span>)</span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co"># 对生成的随机数做直方图</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="fu">hist</span>(res, </span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>     <span class="at">probability =</span> T , </span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co"># 叠加Beta(3, 2)分布的密度曲线</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">12</span><span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x), </span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a>      <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function
<span class="math display">\[f_e(x) = \frac34(1-x^2), \quad \vert x
\vert \leq 1.\]</span> Devroye and Gyorfi give the following algorithm
for simulation from this distribution. Generate i.i.d. <span class="math inline">\(U_1, U_2, U_3\)</span> ~ <span class="math inline">\(U(-1, 1)\)</span>. If <span class="math inline">\(\vert U_3\vert \geq \vert U_2 \vert\)</span> and
<span class="math inline">\(\vert U_3\vert \ge \vert U_1 \vert\)</span>,
deliver <span class="math inline">\(U_2\)</span>; otherwise deliver
<span class="math inline">\(U_3\)</span>. Write a function to generate
random variates from <span class="math inline">\(f_e\)</span>, and
construct the histogram density estimate of a large simulated random
sample.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># generation function</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>my.repanechnikov <span class="ot">&lt;-</span> <span class="cf">function</span>(size){</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> size</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co"># 生成的随机序列储存在向量result中</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="cf">if</span>((<span class="fu">abs</span>(r[<span class="dv">3</span>]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(r[<span class="dv">2</span>])) <span class="sc">&amp;</span> (<span class="fu">abs</span>(r[<span class="dv">3</span>]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(r[<span class="dv">1</span>]))){</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>      result[i] <span class="ot">&lt;-</span> r[<span class="dv">2</span>]</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>      result[i] <span class="ot">&lt;-</span> r[<span class="dv">3</span>]</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    }</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  }</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  </span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>}</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># tests</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">my.repanechnikov</span>(n)</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co"># 对生成的随机数做直方图</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="fu">hist</span>(res, </span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>     <span class="at">probability =</span> T , </span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co"># 叠加Epanechnikov核密度曲线</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">1.5</span>, </span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>      <span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>      <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>Prove that the algorithm given in Ex 3.9 generates variates from the
density <span class="math inline">\(f_e\)</span> in Ex 3.9.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5</h2>
<p><span class="math inline">\(proof.\)</span></p>
<p>令<span class="math inline">\(V = \text{max}\{\vert U_1\vert, \,
\vert U_2\vert, \, \vert U_3\vert\}\)</span>, 并记事件<span class="math inline">\(A=\{V=\vert U_3 \vert\}\)</span>. 由对称性有<span class="math inline">\(\mathbb{P}(A)=\frac13\)</span>, <span class="math inline">\(\mathbb{P}(A^c)=\frac23\)</span>. 易知分布<span class="math inline">\(Uniform(-1, \, 1)\)</span>的密度函数为<span class="math inline">\(f_U(x)=\frac12\text{I}(-1 &lt; x &lt; 1)\)</span>,
累积分布函数为<span class="math inline">\(F_U(x)=\frac{x+1}2, \; x \in
(-1,\, 1)\)</span>.</p>
<p><span class="math inline">\({\forall}x \in (-1,\,1)\)</span>, <span class="math display">\[\begin{aligned}
\mathbb{P}(X \le x)
&amp;= \mathbb{P}(X \le x \vert A)\mathbb{P}(A)+\mathbb{P}(X \le x \vert
A^c)\mathbb{P}(A^c) \\
&amp;= \mathbb{P}(U_2 \le x \vert A) \cdot \frac13+\mathbb{P}(U_3 \le x
\vert A^c) \cdot \frac23 \\
&amp;= \frac{\mathbb{P}(U_2 \le x,\, A)}{\mathbb{P}(A)} \cdot
\frac13+\frac{\mathbb{P}(U_3 \le x,\, A^c)}{\mathbb{P}(A^c)} \cdot
\frac23 \\
&amp;= \mathbb{P}(U_2 \le x,\, V=\vert U_3 \vert)+\mathbb{P}(U_3 \le
x,\, V \neq \vert U_3 \vert) \quad (\star)
\end{aligned}\]</span> 注意到<span class="math display">\[\{U_3 \le x,\,
V \neq \vert U_3 \vert\}=\{U_3 \le x,\, V=\vert U_1 \vert\} \cup \{U_3
\le x,\, V=\vert U_2 \vert\}\]</span>而<span class="math display">\[\{U_3 \le x,\, V=\vert U_1 \vert\} \cap \{U_3 \le
x,\, V=\vert U_2 \vert\} \subset \{\vert U_1 \vert = \vert U_2
\vert\}\]</span>上式右端在<span class="math inline">\(U_1,\,
U_2\)</span> i.i.d. ~ <span class="math inline">\(Uniform(-1,\,
1)\)</span>时为零概率事件, 故 <span class="math display">\[\begin{aligned}
\mathbb{P}(U_3 \le x,\, V \neq \vert U_3 \vert)
&amp;= \mathbb{P}(U_3 \le x,\, V=\vert U_1 \vert)+\mathbb{P}(U_3 \le
x,\, V=\vert U_2 \vert) \\
&amp;\overset{i.i.d}{=} 2\mathbb{P}(U_2 \le x,\, V=\vert U_3 \vert)
\end{aligned}\]</span>从而 <span class="math display">\[\begin{aligned}
(\star)
&amp;= \frac32\mathbb{P}(U_3 \le x,\, V \neq \vert U_3 \vert) \\
&amp;= \frac32[\mathbb{P}(U_3 \le x)-\mathbb{P}(U_3 \le x,\, V=\vert U_3
\vert)] \\
&amp;= \frac32[\frac{x+1}2 - \mathbb{P}(U_3 \le x,\, \vert U_1 \vert \le
\vert U_3 \vert,\, \vert U_2 \vert \le \vert U_3 \vert)] \quad (\star
\star)
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
\mathbb{P}(U_3 \le x,\, \vert U_1 \vert \le \vert U_3 \vert ,\, \vert
U_2 \vert \le \vert U_3 \vert \, \Big| \, U_3 = y)
&amp;= \mathbb{P}(y \le x,\, \vert U_1 \vert \le \vert y \vert ,\, \vert
U_2 \vert \le \vert y \vert \, \Big| \, U_3 = y) \\
&amp;= \text{I}(y \le x) \cdot \mathbb{P}(\vert U_1 \vert \le \vert y
\vert) \cdot \mathbb{P}(\vert U_2 \vert \le y) \\
&amp;= \vert y \vert^2 \cdot \text{I}(y \le x)
\end{aligned}\]</span>于是 <span class="math display">\[\begin{aligned}
\mathbb{P}(U_3 \le x,\, \vert U_1 \vert \le \vert U_3 \vert ,\, \vert
U_2 \vert \le \vert U_3 \vert)
&amp;= \mathbb{E}[\mathbb{P}(U_3 \le x,\, \vert U_1 \vert \le \vert U_3
\vert ,\, \vert U_2 \vert \le \vert U_3 \vert \, \Big| \, U_3)] \\
&amp;= \mathbb{E}[\vert U_3 \vert^2 \text{I}(U_3 \le x)] \\
&amp;= \int_{-\infty}^x \vert y \vert^2 f_U(y) dy \\
&amp;= \int_{-\infty}^x y^2 \cdot \frac12 \text{I}(-1 \le y \le 1) dy \\
&amp;= \int_{-1}^x \frac12 y^2 dy \\
&amp;= \frac{x^3+1}6
\end{aligned}\]</span>从而 <span class="math display">\[\begin{aligned}
(\star \star)
&amp;= \frac32(\frac{x+1}2-\frac{x^3+1}6) \\
&amp;= \frac34(x+1-\frac{x^3+1}3)
\end{aligned}\]</span>即: <span class="math inline">\({\forall}x \in
(-1,\, 1)\)</span>, <span class="math inline">\(\mathbb{P}(X \le
x)=\frac34(x+1-\frac{x^3+1}3)\)</span>, 故<span class="math inline">\(\frac{d\mathbb{P}(X \le
x)}{dx}=\frac34(1-x^2)=f_e(x)\)</span>.</p>
<p>证毕.</p>
</div>
<div id="section-1" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>What value should <span class="math inline">\(\rho=\frac l d\)</span>
take to minimize the asymptotic variace of <span class="math inline">\(\hat{\pi}=\frac{2\rho}{\hat{p}}\)</span>, where
<span class="math inline">\(\hat{p}=\frac m n\)</span>?</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>Buffon投针试验的成功概率为<span class="math inline">\(p=\frac{2\rho}{\pi}\)</span>, 其中<span class="math inline">\(\rho=\frac l d\)</span>. 设<span class="math inline">\(n\)</span>次投针试验的成功次数为<span class="math inline">\(m\)</span>, 则<span class="math inline">\(m\)</span>~<span class="math inline">\(B(n,\,
p)\)</span>, 用频率来估计概率可得<span class="math inline">\(\hat{\pi}=\frac{2\rho}{\hat{p}}\)</span>,
其中<span class="math inline">\(\hat{p}=\frac m n\)</span>. 记<span class="math inline">\(\sigma^2=p(1-p)\)</span>, 由CLT, <span class="math inline">\(\sqrt{n}(\hat{p}-p) \stackrel{d}{\rightarrow} N(0,
\sigma^2)\)</span>. 现令<span class="math inline">\(g(x)=\frac{2\rho}{x}\)</span>, <span class="math inline">\(g&#39;(x)=-\frac{2\rho}{x^2}\)</span>, <span class="math inline">\(g&#39;(p)=-\frac{2\rho}{p^2}=-\frac{\pi^2}{2\rho}
\neq 0\)</span>, 故由Delta定理, <span class="math inline">\(\sqrt{n}(g(\hat{p})-g(p))
\stackrel{d}{\rightarrow} N(0, \sigma^2(g&#39;(p))^2)\)</span>, 即<span class="math inline">\(\hat{\pi}\)</span>的渐近方差为<span class="math inline">\(\frac{\sigma^2(g&#39;(p))^2}{n}=\frac{\sigma^2(-\frac{\pi^2}{2\rho})^2}{n}=\frac{p(1-p)\frac{\pi^4}{4\rho^2}}{n}=\frac{\pi^2}{2n}
\cdot \frac{\pi-2\rho}{\rho}=\frac{\pi^2}{2n} \cdot (\frac \pi
\rho-2)\)</span>. 由于<span class="math inline">\(l \le d\)</span>,
因此使得<span class="math inline">\(\hat{\pi}\)</span>的渐近方差最小化的<span class="math inline">\(\rho\)</span>为<span class="math inline">\(\rho_{min}=1\)</span>, 最小渐近方差为<span class="math inline">\(\frac{\pi^2(\pi-2)}{2n}\)</span>.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Take 3 different values of <span class="math inline">\(\rho\; (0 \le
\rho \le 1,\, \text{including } \rho_{min})\)</span> and use Monte-Carlo
simulation to verify your answer.(<span class="math inline">\(n=10^6,\,
\text{number of repeated simulations } K=100\)</span>)</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># rho_min = 1, 另外两个rho为0.5、0.8</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co"># 固定两平行线之间的距离d, 针长l = rho * d的改变通过rho的改变来实现</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co"># 重复模拟次数</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># 每次模拟的投针次数</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co"># 模拟结果存储在该列表中</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;rho_is_1&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(K), </span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>               <span class="st">&quot;rho_is_0.5&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(K), </span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>               <span class="st">&quot;rho_is_0.8&quot;</span> <span class="ot">=</span> <span class="fu">numeric</span>(K))</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>    l <span class="ot">&lt;-</span> d<span class="sc">*</span>rho[i]</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>    pi_hat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho[i]<span class="sc">/</span><span class="fu">mean</span>((l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y))<span class="sc">&gt;</span>X)</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>    result[[i]][k] <span class="ot">&lt;-</span> pi_hat</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>  }</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>}</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co"># rho = 1的方差</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="fu">var</span>(result<span class="sc">$</span>rho_is_1)</span></code></pre></div>
<pre><code>## [1] 5.330487e-06</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># rho = 0.5的方差</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">var</span>(result<span class="sc">$</span>rho_is_0<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## [1] 1.799878e-05</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># rho = 0.8的方差</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">var</span>(result<span class="sc">$</span>rho_is_0<span class="fl">.8</span>)</span></code></pre></div>
<pre><code>## [1] 1.02441e-05</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>5.6 In Example 5.7 the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[\theta=\int_0^1
e^xdx.\]</span> Now consider the antithetic variate approach. Compute
<span class="math inline">\(Cov(e^U,\, e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\)</span> ~ Uniform(0, 1). What is the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>首先, <span class="math inline">\(Cov(e^U,\, e^{1-U})=\mathbb{E}(e^U
\cdot e^{1-U})-\mathbb{E}(e^U) \cdot
\mathbb{E}(e^{1-U})=e-(e-1)^2=-e^2+3e-1.\)</span></p>
<p>其次, <span class="math inline">\(Var(e^U+e^{1-U})=\mathbb{E}(e^U+e^{1-U})^2-[\mathbb{E}(e^U+e^{1-U})]^2=(\text{I})-(\text{II})\)</span>,
其中<span class="math inline">\((\text{I})=\mathbb{E}(e^{2U}+e^{2-2U}+2e)=\frac{e^2-1}{2}+\frac{e^2-1}{2}+2e=e^2+2e-1\)</span>,
<span class="math inline">\((\text{II})=(e-1+e-1)^2=4(e-1)^2\)</span>,
故<span class="math inline">\(Var(e^U+e^{1-U})=-3e^2+10e-5.\)</span></p>
<p>对于<span class="math inline">\(\theta=\int_0^1e^xdx\)</span>,
简单MC估计量为<span class="math inline">\(\hat{\theta_1}=\frac 1 n
\sum_{i=1}^n e^{U_i}\)</span>, 对偶变量估计量为<span class="math inline">\(\hat{\theta_2}=\frac 1 n \sum_{i=1}^{\frac n
2}(e^{U_i}+e^{1-U_i}).\)</span></p>
<p><span class="math inline">\(Var(\hat{\theta_1})=Var(\frac 1 n
\sum_{i=1}^n e^{U_i})=\frac 1 n Var(e^{U_1})=\frac 1 n
[\mathbb{E}e^{2U}-(\mathbb{E}e^U)^2]=\frac 1
n[\frac{e^2-1}{2}-(e-1)^2]=\frac{-e^2+4e-3}{2n}\)</span></p>
<p><span class="math inline">\(Var({\hat{\theta_2}})=Var(\frac 1 n
\sum_{i=1}^{\frac n 2}(e^{U_i}+e^{1-U_i}))=\frac{1}{n^2} \cdot \frac n 2
Var(e^{U_1}+e^{1-U_1})=\frac{-3e^2+10e-5}{2n}\)</span></p>
<p>因此对偶变量估计量的方差比简单MC估计量的方差减少百分比为: <span class="math inline">\(\frac{Var({\hat{\theta_1}})-Var({\hat{\theta_2}})}{Var({\hat{\theta_1}})}
\times
100\%=\frac{\frac{-e^2+4e-3}{2n}-\frac{-3e^2+10e-5}{2n}}{\frac{-e^2+4e-3}{2n}}
\times 100\% \approx 96.77 \%\)</span></p>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate
<span class="math inline">\(\theta\)</span> by the antithetic variate
approach and by the simple Monte Carlo method. Compute an empirical
estimate of the percent reduction in variance using the antithetic
variate. Compare the result with the theoretical value from Exercise
5.6.</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># 产生N个均匀随机变量用以计算MC估计量</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># 重复模拟K次</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co"># simple MC method</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>theta1_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  theta1_hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u))</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>}</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>va1 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta1_hat); va1</span></code></pre></div>
<pre><code>## [1] 0.0001269217</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># antithetic variate approach</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>theta2_hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  theta2_hat[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">exp</span>(u) <span class="sc">+</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">/</span>N</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>va2 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta2_hat); va2</span></code></pre></div>
<pre><code>## [1] 3.935876e-06</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># 方差减少的百分比</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">round</span>((va1<span class="sc">-</span>va2)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>va1, <span class="dv">2</span>), <span class="st">&#39;%&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<pre><code>## 96.9%</code></pre>
</div>
<div id="section-2" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Prove that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a,\,b)\)</span>, then <span class="math inline">\(\frac{\text{Var}(\hat{\theta}^S)}{\text{Var}(\hat{\theta}^M)}
\rightarrow 0\)</span> as <span class="math inline">\(b_i-a_i
\rightarrow 0\)</span> for all <span class="math inline">\(i=1,\,2,\,\dots,\,k\)</span>.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(Var(\hat{\theta}^S)=\frac{1}{Mk}\sum_{i=1}^k
Var\big[g(U)\,\vert\,I=i\big]\)</span>.</p>
<p>记<span class="math inline">\(\bar{\theta}=\mathbb{E}\theta_I=\mathbb{E}\big[\mathbb{E}(\theta_I
\,\vert\,I)\big]=\sum_{i=1}^k\mathbb{P}(I=i)\cdot
\mathbb{E}\big(\theta_I\,\vert\,I=i\big)=\frac1k\sum_{i=1}^k\theta_i\)</span>.</p>
<p><span class="math inline">\(\frac1MVar(\theta_I)=\frac1M
\mathbb{E}\big[ \theta_I -\mathbb{E}\theta_I
\big]^2=\frac1M\mathbb{E}(\theta_I-\bar{\theta})^2=\frac1M\mathbb{E}\{
\mathbb{E}\big[(\theta_I-\bar{\theta})^2\,\vert\,
I\big]\}=\frac1M\sum_{i=1}^k\mathbb{P}(I=i)\cdot\mathbb{E}\big[(\theta_I-\bar{\theta})^2\,\vert\,I=i\big]=\frac{1}{Mk}\sum_{i=1}^k(\theta_i-\bar{\theta})^2\)</span>.</p>
<p>问题等价于证明<span class="math inline">\(\frac{Var(\hat{\theta}^S)}{\frac1MVar(\theta_I)}
\rightarrow 0\)</span>. <span class="math display">\[\begin{aligned}
\frac{Var(\hat{\theta}^S)}{\frac1MVar(\theta_I)}
&amp;= \frac{\frac{1}{Mk}\sum_{i=1}^kVar\big[ g(U) \,\Big\vert\,I=i
\big]}{\frac{1}{Mk}\sum_{i=1}^k(\theta_i-\bar{\theta})^2} \\
&amp;= \frac{\sum_{i=1}^kVar\big[ g(U) \,\Big\vert\,I=i
\big]}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2} \\
&amp;=
\frac{\sum_{i=1}^kVar[g(U_{1i})]}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;= \frac{\sum_{i=1}^k\mathbb{E}\big[
g(U_{1i})-\mathbb{E}g(U_{1i})\big]^2}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\quad (*)
\end{aligned}\]</span> 注意到<span class="math inline">\(\theta_i=\mathbb{E}\big[g(U)
\,\Big\vert\,I=i\big]=\mathbb{E}g(U_{1i})\)</span>,而<span class="math inline">\(U_{1i}\)</span> ~ <span class="math inline">\(Uniform(a_i,\,b_i)\)</span> 因此: <span class="math display">\[\begin{aligned}
(*)
&amp;= \frac{\sum_{i=1}^k\mathbb{E}\big[
g(U_{1i})-\theta_i\big]^2}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2} \\
&amp;= \frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big[
g(t)-\theta_i\big]^2\frac{dt}{b_i-a_i}}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;= \frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big[
g(t)-\bar{\theta}+\bar{\theta}-\theta_i\big]^2\frac{dt}{b_i-a_i}}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;=
\frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)^2\frac{dt}{b_i-a_i}+\sum_{i=1}^k\int_{a_i}^{b_i}\big(\theta_i-\bar{\theta}\big)^2\frac{dt}{b_i-a_i}+2\sum_{i=1}^k\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)(\bar{\theta}-\theta_i)\frac{dt}{b_i-a_i}}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;=
\frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)^2\frac{dt}{b_i-a_i}+\sum_{i=1}^k(\theta_i-\bar{\theta})^2-2\sum_{i=1}^k(\theta_i-\bar{\theta})\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)\frac{dt}{b_i-a_i}}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;=
\frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)^2\frac{dt}{b_i-a_i}+\sum_{i=1}^k(\theta_i-\bar{\theta})^2-2\sum_{i=1}^k(\theta_i-\bar{\theta})^2}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}
\\
&amp;=
\frac{\sum_{i=1}^k\int_{a_i}^{b_i}\big(g(t)-\bar{\theta}\big)^2\frac{dt}{b_i-a_i}}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}-1\\
&amp;=
\frac{\sum_{i=1}^k\mathbb{E}[g(U_{1i})-\bar{\theta}]^2}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}-1
\quad (**)
\end{aligned}\]</span> 显然当<span class="math inline">\(b_i-a_i
\rightarrow 0\;(\Rightarrow k \rightarrow \infty)\)</span>时, <span class="math inline">\((**) \rightarrow
\frac{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}{\sum_{i=1}^k(\theta_i-\bar{\theta})^2}-1=0\)</span></p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\, \infty)\)</span> and are ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1\)</span>. Which of your two importance functions should produce
the smaller variance in estimating <span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> by importance sampling?
Explain.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p><span class="math inline">\(f_1(x)=e^{1-x},\;x&gt;1\)</span>.</p>
<p><span class="math inline">\(f_2(x)=xe^{\frac{1-x^2}{2}},\;x&gt;1\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">100</span> <span class="co">#重复模拟100次</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span> <span class="co">#每次产生的随机数个数</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#用f_1估计的结果向量</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#用f_2估计的结果向量</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co"># 3个函数</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co"># 用f_1进行估计</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  <span class="co"># 用逆变换法产生m个来自f1分布的随机数</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  f1_rev <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">f1_rev</span>(u)</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  res1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))<span class="sc">/</span>m</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>}</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co"># 用f_2进行估计</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>  <span class="co"># 用逆变换法产生m个来自f2分布的随机数</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  f2_rev <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">f2_rev</span>(u)</span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>  res2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x))<span class="sc">/</span>m</span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a>}</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co"># 求方差, 可以看出用f2求出的估计方差更小</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="fu">var</span>(res1)</span></code></pre></div>
<pre><code>## [1] 2.841719e-05</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">var</span>(res2)</span></code></pre></div>
<pre><code>## [1] 1.653238e-05</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># 作图分别查看f1与g、f2与g的正比关系:</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>f1_g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">f1</span>(x)<span class="sc">/</span><span class="fu">g</span>(x)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>f2_g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">f2</span>(x)<span class="sc">/</span><span class="fu">g</span>(x)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">f1_g</span>(x), </span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">5</span>, </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&#39;x&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;proportion&#39;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">f2_g</span>(x), </span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>      <span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">5</span>, </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>      <span class="at">add =</span> T)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>,</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;red&#39;</span>), </span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;f1 vs g&#39;</span>, <span class="st">&#39;f2 vs g&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># 显然f2与g的正比关系更强</span></span></code></pre></div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>Obtain a Monte Carlo estimate of <span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> by importance sampling.</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p>在Question 2的解答中已经用Monte
Carlo方法给出了在两种重要性函数下目标参数的估计，并分别重复模拟了100次，这里直接给出Answer
2中的结果向量的部分值:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">head</span>(res1)</span></code></pre></div>
<pre><code>## [1] 0.3906320 0.3962580 0.3962332 0.3924979 0.3992230 0.4000920</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">head</span>(res2)</span></code></pre></div>
<pre><code>## [1] 0.3975481 0.4024028 0.4050297 0.3991408 0.4037631 0.4046884</code></pre>
</div>
<div id="question-4-2" class="section level2">
<h2>Question 4</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>第<span class="math inline">\(j\)</span>个区间上的重要性函数为<span class="math display">\[f_j(x)=\frac{5e^{j-1-5x}}{1-e^{-1}},\quad\frac{j-1}{5}&lt;x&lt;\frac
j5.\]</span> 经过简单积分运算可知<span class="math inline">\(f_j(x)\)</span>对应的累积分布函数为<span class="math display">\[F_j(x)=\frac{1}{1-e^{-1}}\big(1-e^{j-1-5x}
\big),\quad \frac{j-1}{5}&lt;x&lt;\frac j5.\]</span> 目标参数为<span class="math display">\[\theta=\int_0^1\frac{e^{-t}}{1+t^2}dt,\]</span>
其中<span class="math display">\[g(x)=\frac{e^{-x}}{1+x^2}.\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># 分成k = 5个区间</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co"># 每个区间生成5000个随机数</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="co"># 目标参数的被积函数</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (<span class="fu">exp</span>(<span class="sc">-</span>x))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co"># 第j个区间的条件密度函数f_j</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>fj <span class="ot">&lt;-</span> <span class="cf">function</span>(x, j){</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  <span class="dv">5</span> <span class="sc">*</span> <span class="fu">exp</span>(j<span class="dv">-1-5</span><span class="sc">*</span>x)<span class="sc">*</span>(x <span class="sc">&gt;</span> ((j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>))<span class="sc">*</span>(x <span class="sc">&lt;</span> (j<span class="sc">/</span><span class="dv">5</span>)) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>}</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co"># f_j对应的分布函数</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>Fj <span class="ot">&lt;-</span> <span class="cf">function</span>(x, j) (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(j<span class="dv">-1-5</span><span class="sc">*</span>x)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co"># f_j对应的分布函数的反函数</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>Fj_rev <span class="ot">&lt;-</span> <span class="cf">function</span>(x, j) (j <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> (<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>x))<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co"># 初始化</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a><span class="co"># stratified importance sampling estimation</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>  <span class="co"># 逆变换法生成来自密度f_j的随机数</span></span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">Fj_rev</span>(u, j)</span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>  <span class="co"># 逐个区间进行分段积分的估计, 然后累加得到全区间积分的最终估计</span></span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> theta_hat <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x, j))<span class="sc">/</span>m</span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a>}</span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a><span class="co"># 最终估计值, 可以看出与Example 5.10的结果是非常接近的</span></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a>theta_hat</span></code></pre></div>
<pre><code>## [1] 0.5241849</code></pre>
</div>
<div id="question-5-1" class="section level2">
<h2>Question 5</h2>
<p>Suppose a <span class="math inline">\(95%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean,
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
<span class="math inline">\(t\)</span>-interval for random samples of
<span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n = 20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation
results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
</div>
<div id="answer-5-1" class="section level2">
<h2>Answer 5</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># 重复模拟m次</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co"># 每次模拟的样本容量为n</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co"># 自由度为n-1的t分布的上0.025分位数(均值采用双边检验)</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span>)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="co"># 自由度为n-1的卡方分布的下0.05分位数(方差采用单边检验)</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.05</span>, n<span class="dv">-1</span>)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="co"># 指示向量，用来指示每次置信区间是否包含目标参数</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>res_mean <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>res_var <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>  <span class="co"># 生成简单卡方样本</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>)</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  </span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  <span class="co"># 卡方均值的t区间估计</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  mean_lower_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">-</span> c1 <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x)) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  mean_upper_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> c1 <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x)) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>  <span class="co"># 本次t区间估计是否覆盖真实卡方均值</span></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  res_mean[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((mean_lower_hat <span class="sc">&lt;=</span> <span class="dv">2</span>)<span class="sc">&amp;</span>(mean_upper_hat <span class="sc">&gt;=</span> <span class="dv">2</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  </span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>  <span class="co"># 卡方方差的区间估计</span></span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>  var_lower_hat <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span>c2</span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="co"># 本次区间估计是否覆盖真实卡方方差</span></span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  res_var[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(var_lower_hat <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>}</span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a><span class="co"># 均值的覆盖概率估计</span></span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a>mean_CP_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(res_mean)</span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a>mean_CP_hat</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># 方差的覆盖概率估计</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>var_CP_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(res_var)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>var_CP_hat</span></code></pre></div>
<pre><code>## [1] 0.7829</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p><span class="math inline">\(m=1000\)</span>个假设，前95%个原假设成立，后5%个备择假设成立。在原假设之下，p值服从0到1上的均匀分布，在备择假设下，p值服从<span class="math inline">\(Beta(0.1,\,1)\)</span>分布。将Bonferroni校正与B-H校正
应用于生成的<span class="math inline">\(m\)</span>个p值，得到校正后的p值，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设。基于M=1000次模拟，估计FWER、FDR、TPR，输出到表格中。</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 1000次重复模拟</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># 显著性水平alpha</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">0.1</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># beta分布的参数</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>p_bon <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># 经过Bonferroni校正的1000组p值结果列表</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>p_BH <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># 经过BH校正的1000组p值结果列表</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="co"># 1000次校正过程</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">950</span>), <span class="fu">rbeta</span>(<span class="dv">50</span>, b1, b2))</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  p_bon[[i]] <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>  p_BH[[i]] <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>}</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a><span class="co"># 两种校正后的FWER估计值</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>FWER_bon_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>FWER_BH_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  FWER_bon_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_bon[[i]][<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> a) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  FWER_BH_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_BH[[i]][<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> a) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>FWER_bon <span class="ot">&lt;-</span> <span class="fu">mean</span>(FWER_bon_vec)</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>FWER_BH <span class="ot">&lt;-</span> <span class="fu">mean</span>(FWER_BH_vec)</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="co"># 两种校正后的FDR估计值</span></span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>FDR_bon_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>FDR_BH_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a>  FDR_bon_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_bon[[i]][<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> a)<span class="sc">/</span><span class="fu">sum</span>(p_bon[[i]] <span class="sc">&lt;</span> a))</span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>  FDR_BH_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_BH[[i]][<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> a)<span class="sc">/</span><span class="fu">sum</span>(p_BH[[i]] <span class="sc">&lt;</span> a))</span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>}</span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a>FDR_bon <span class="ot">&lt;-</span> <span class="fu">mean</span>(FDR_bon_vec)</span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a>FDR_BH <span class="ot">&lt;-</span> <span class="fu">mean</span>(FDR_BH_vec)</span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a></span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a><span class="co"># 两种校正后的TPR估计值</span></span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a>TPR_bon_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a>TPR_BH_vec <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a>  TPR_bon_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_bon[[i]][<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> a)<span class="sc">/</span><span class="dv">50</span>)</span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a>  TPR_BH_vec[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p_BH[[i]][<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> a)<span class="sc">/</span><span class="dv">50</span>)</span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a>}</span>
<span id="cb43-41"><a href="#cb43-41" tabindex="-1"></a>TPR_bon <span class="ot">&lt;-</span> <span class="fu">mean</span>(TPR_bon_vec)</span>
<span id="cb43-42"><a href="#cb43-42" tabindex="-1"></a>TPR_BH <span class="ot">&lt;-</span> <span class="fu">mean</span>(TPR_BH_vec)</span>
<span id="cb43-43"><a href="#cb43-43" tabindex="-1"></a></span>
<span id="cb43-44"><a href="#cb43-44" tabindex="-1"></a><span class="co"># results of Bonferroni adjustment</span></span>
<span id="cb43-45"><a href="#cb43-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(FWER_bon, FDR_bon, TPR_bon), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.094 0.005 0.399</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># results of B-H adjustment</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(FWER_BH, FDR_BH, TPR_BH), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.931 0.097 0.559</code></pre>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>Evaluation on the bootstrap method based on exponential
population.</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 重复模拟1000次</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 每次模拟bootstrap采样次数</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>) <span class="co"># 样本量大小</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="co"># 各参数理论值</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>bias <span class="ot">&lt;-</span> lambda<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>se <span class="ot">&lt;-</span> lambda<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="co"># bootstrap procedure</span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="co"># 3种样本量</span></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n[<span class="dv">1</span>], lambda)</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n[<span class="dv">2</span>], lambda)</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n[<span class="dv">3</span>], lambda)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="co"># 参数lambda在各样本下的m次bootstrap估计</span></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>lambda1_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>lambda2_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>lambda3_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="co"># 偏差在各样本下的m次bootstrap估计</span></span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>bias1_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>bias2_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>bias3_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a><span class="co"># 标准差在各样本下的m次bootstrap估计</span></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>se1_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>se2_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>se3_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>  <span class="co"># 第i次重复模拟时各样本的lambda在B次重采样中的bootstrap估计值</span></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>  lambda1_temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>  lambda2_temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>  lambda3_temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>  </span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a>  <span class="co"># 进行B次重采样</span></span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>    <span class="co"># 对3个样本分别生成重采样样本</span></span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a>    x1_boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1, <span class="at">replace =</span> T)</span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a>    x2_boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(x2, <span class="at">replace =</span> T)</span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>    x3_boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(x3, <span class="at">replace =</span> T)</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a>    <span class="co"># 3个样本在第j次重采样的lambda估计</span></span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a>    lambda1_temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x1_boot)</span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a>    lambda2_temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x2_boot)</span>
<span id="cb47-44"><a href="#cb47-44" tabindex="-1"></a>    lambda3_temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x3_boot)</span>
<span id="cb47-45"><a href="#cb47-45" tabindex="-1"></a>  }</span>
<span id="cb47-46"><a href="#cb47-46" tabindex="-1"></a>  </span>
<span id="cb47-47"><a href="#cb47-47" tabindex="-1"></a>  <span class="co"># 取B次重采样lambda估计的均值作为lambda的第i次bootstrap估计</span></span>
<span id="cb47-48"><a href="#cb47-48" tabindex="-1"></a>  lambda1_boot[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda1_temp)</span>
<span id="cb47-49"><a href="#cb47-49" tabindex="-1"></a>  lambda2_boot[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda2_temp)</span>
<span id="cb47-50"><a href="#cb47-50" tabindex="-1"></a>  lambda3_boot[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda3_temp)</span>
<span id="cb47-51"><a href="#cb47-51" tabindex="-1"></a>  <span class="co"># 取B次lambda估计的均值与原样本lambda估计的差作为bias的第i次bootstrap估计</span></span>
<span id="cb47-52"><a href="#cb47-52" tabindex="-1"></a>  bias1_boot[i] <span class="ot">&lt;-</span> lambda1_boot[i] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x1)</span>
<span id="cb47-53"><a href="#cb47-53" tabindex="-1"></a>  bias2_boot[i] <span class="ot">&lt;-</span> lambda2_boot[i] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x2)</span>
<span id="cb47-54"><a href="#cb47-54" tabindex="-1"></a>  bias3_boot[i] <span class="ot">&lt;-</span> lambda3_boot[i] <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x3)</span>
<span id="cb47-55"><a href="#cb47-55" tabindex="-1"></a>  <span class="co"># 取B次lambda估计的标准差作为se的第i次bootstrap估计</span></span>
<span id="cb47-56"><a href="#cb47-56" tabindex="-1"></a>  se1_boot[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda1_temp)</span>
<span id="cb47-57"><a href="#cb47-57" tabindex="-1"></a>  se2_boot[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda2_temp)</span>
<span id="cb47-58"><a href="#cb47-58" tabindex="-1"></a>  se3_boot[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda3_temp)</span>
<span id="cb47-59"><a href="#cb47-59" tabindex="-1"></a>}</span>
<span id="cb47-60"><a href="#cb47-60" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" tabindex="-1"></a><span class="co"># comparison between mean bootstrap bias and the theoretical one</span></span>
<span id="cb47-62"><a href="#cb47-62" tabindex="-1"></a><span class="fu">print</span>(bias)</span></code></pre></div>
<pre><code>## [1] 0.5000000 0.2222222 0.1052632</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(bias1_boot), <span class="fu">mean</span>(bias2_boot), <span class="fu">mean</span>(bias3_boot)))</span></code></pre></div>
<pre><code>## [1] 0.45945918 0.07515272 0.04592907</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># comparison between mean bootstrap standard error and the theoretical one</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 1.4433757 0.7856742 0.4962153</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(se1_boot), <span class="fu">mean</span>(se2_boot), <span class="fu">mean</span>(se3_boot)))</span></code></pre></div>
<pre><code>## [1] 1.3975432 0.3974317 0.2882535</code></pre>
<p>可以看到，当样本量过小，如n=5时，bootstrap估计的结果与理论值相差非常大，当逐渐增加样本量时，bias和se的bootstrap估计效果会逐渐提升，当n=20时，bootstrap估计值与理论值的差距已经很小。</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap)</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">str</span>(law)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    15 obs. of  2 variables:
##  $ LSAT: num  576 635 558 578 666 580 555 661 651 605 ...
##  $ GPA : num  3.39 3.3 2.81 3.03 3.44 3.07 3 3.43 3.36 3.13 ...</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># 进行B次重采样(一阶、二阶)</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>R1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 一阶重采样中相关系数的bootstrap估计</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>se_R1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 一阶重采样相关系数bootstrap估计的标准差估计</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT, law<span class="sc">$</span>GPA) <span class="co"># 原始样本的相关系数估计</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># 置信区间置信度为95%</span></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a><span class="co"># bootstrap</span></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  <span class="co"># 第i次重采样样本</span></span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  id1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(law), <span class="at">replace =</span> T)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  <span class="co"># 第i次重采样中相关系数的bootstrap估计</span></span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>  R1[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT[id1], law<span class="sc">$</span>GPA[id1])</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>  </span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>  <span class="co"># 下面需要利用bootstrap估计第i次重采样样本相关系数估计的标准差</span></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>  </span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>  <span class="co"># 对第i次重采样样本进行二阶重采样</span></span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co"># 二阶重采样相关系数的bootstrap估计</span></span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a>    id2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(id1, <span class="at">replace =</span> T)</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a>    R2[j] <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT[id2], law<span class="sc">$</span>GPA[id2])</span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a>  }</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a>  se_R1[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(R2)</span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a>}</span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a></span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a><span class="co"># 分位数估计</span></span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>((R1 <span class="sc">-</span> R_hat)<span class="sc">/</span>se_R1, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a><span class="fu">names</span>(Q) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a></span>
<span id="cb57-29"><a href="#cb57-29" tabindex="-1"></a><span class="co"># R_hat的标准差的bootstrap估计</span></span>
<span id="cb57-30"><a href="#cb57-30" tabindex="-1"></a>se_R_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(R1)</span>
<span id="cb57-31"><a href="#cb57-31" tabindex="-1"></a></span>
<span id="cb57-32"><a href="#cb57-32" tabindex="-1"></a><span class="co"># t置信区间的bootstrap估计</span></span>
<span id="cb57-33"><a href="#cb57-33" tabindex="-1"></a>R_hat <span class="sc">-</span> se_R_hat<span class="sc">*</span>Q</span></code></pre></div>
<pre><code>## [1] -0.4941823  0.9657891</code></pre>
</div>
<div id="section-4" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>,<span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a><span class="co"># 统计量：均值</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">mean</span>(x[i])</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a><span class="co"># 统计量的bootstrap估计</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> data, <span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a><span class="fu">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data, statistic = boot.mean, R = 999)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 -0.890307    37.50011</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co"># 四种区间</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot.obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&#39;norm&#39;</span>, <span class="st">&#39;basic&#39;</span>, <span class="st">&#39;perc&#39;</span>, <span class="st">&#39;bca&#39;</span>))</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.5, 182.5 )   ( 28.2, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.9, 188.0 )   ( 57.3, 236.5 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="co"># 数据集</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="fu">str</span>(scor)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    88 obs. of  5 variables:
##  $ mec: num  77 63 75 55 63 53 51 59 62 64 ...
##  $ vec: num  82 78 73 72 63 61 67 70 60 72 ...
##  $ alg: num  67 80 71 63 65 72 65 68 58 60 ...
##  $ ana: num  67 70 66 70 70 64 65 62 62 62 ...
##  $ sta: num  81 81 81 68 63 73 68 56 70 45 ...</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">head</span>(scor)</span></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63
## 6  53  61  72  64  73</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># theta_hat估计</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a><span class="co"># 样本协方差阵(为MLE估计) </span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor)</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a><span class="co"># 对样本协方差阵作谱分解</span></span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>eigen_decompos <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a><span class="co"># 求解第一主成分解释的比例</span></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> eigen_decompos[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen_decompos[[<span class="dv">1</span>]])</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>theta_hat</span></code></pre></div>
<pre><code>## [1] 0.636196</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co"># Jacknife方法</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  sigma_jack <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor[<span class="sc">-</span>i, ])</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  theta_jack[i] <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma_jack)[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(sigma_jack)[[<span class="dv">1</span>]])</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>}</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a><span class="co"># 偏差的Jacknife估计</span></span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>bias_jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>bias_jack</span></code></pre></div>
<pre><code>## [1] -0.0003778535</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="co"># 标准差的Jacknife估计</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>sd_jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(theta_jack))</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>sd_jack</span></code></pre></div>
<pre><code>## [1] 0.04492281</code></pre>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="co"># 读取并查看数据</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">library</span>(SA23204171)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a><span class="co"># leave-two-out cross-validation(n/2 fold CV)</span></span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ironslag)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)){</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)]</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)]</span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a>  </span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)]</span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>  e1[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="sc">-</span> yhat1</span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a>  </span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="sc">+</span> </span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a>           J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb73-20"><a href="#cb73-20" tabindex="-1"></a>  e2[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="sc">-</span> yhat2</span>
<span id="cb73-21"><a href="#cb73-21" tabindex="-1"></a>  </span>
<span id="cb73-22"><a href="#cb73-22" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb73-23"><a href="#cb73-23" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> ironslag<span class="sc">$</span>chemical[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)]</span>
<span id="cb73-24"><a href="#cb73-24" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb73-25"><a href="#cb73-25" tabindex="-1"></a>  e3[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="sc">-</span> yhat3</span>
<span id="cb73-26"><a href="#cb73-26" tabindex="-1"></a>  </span>
<span id="cb73-27"><a href="#cb73-27" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span><span class="fu">log</span>(x))</span>
<span id="cb73-28"><a href="#cb73-28" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(ironslag<span class="sc">$</span>chemical[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)])</span>
<span id="cb73-29"><a href="#cb73-29" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb73-30"><a href="#cb73-30" tabindex="-1"></a>  e4[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="dv">-1</span>, <span class="dv">2</span><span class="sc">*</span>k)] <span class="sc">-</span> yhat4</span>
<span id="cb73-31"><a href="#cb73-31" tabindex="-1"></a>}</span>
<span id="cb73-32"><a href="#cb73-32" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1]  889.9197  893.4244 1065.4040 1030.5156</code></pre>
<p>可以看出此时选择第一个模型最好。</p>
</div>
<div id="section-5" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>Prove the Stationarity of M-H sampler Algorithm in continuous
situation.</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<p>Proof. 当<span class="math inline">\(r=s\)</span>时, 等式显然成立.
当<span class="math inline">\(r \neq s\)</span>时, <span class="math inline">\(K(r,s)=\alpha(r,s)g(s|r)\)</span>.</p>
<p><span class="math inline">\(K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)=\begin{cases}
f(r)g(s|r)\cdot\frac{f(s)g(r|s)}{f(r)g(s|r)}, &amp;
f(s)g(r|s)&lt;f(r)g(s|r) \\ f(r)g(s|r), &amp; f(s)g(r|s)&gt;f(r)g(s|r)
\end{cases}\)</span>, 从而<span class="math inline">\(K(r,s)f(r)=\begin{cases} f(s)g(r|s), &amp;
f(s)g(r|s)&lt;f(r)g(s|r) \\ f(r)g(s|r), &amp; f(s)g(r|s)&gt;f(r)g(s|r)
\end{cases}\)</span>.</p>
<p><span class="math inline">\(K(s,r)f(s)=\alpha(s,r)g(r|s)f(s)=\begin{cases}
f(s)g(r|s)\cdot\frac{f(r)g(s|r)}{f(s)g(r|s)}, &amp;
f(r)g(s|r)&lt;f(s)g(r|s) \\ f(s)g(r|s), &amp; f(r)g(s|r)&gt;f(s)g(r|s)
\end{cases}\)</span>, 从而<span class="math inline">\(K(s,r)f(s)=\begin{cases} f(s)g(r|s), &amp;
f(s)g(r|s)&lt;f(r)g(s|r) \\ f(r)g(s|r), &amp; f(s)g(r|s)&gt;f(r)g(s|r)
\end{cases}\)</span>.</p>
<p>因此<span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>,
满足平稳性要求.</p>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<p>Cramer-von Mises stat.: <span class="math inline">\(W_2=\frac{mn}{(m+n)^2}\bigg[\sum_{i=1}^n\Big(F_n(x_i)
- G_m(x_i)\Big)^2 + \sum_{j=1}^m\Big(F_n(y_j) - G_m(y_j)\Big)^2
\bigg]\)</span></p>
<p>分析例8.1:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># 导入数据</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a><span class="fu">str</span>(x); <span class="fu">str</span>(y)</span></code></pre></div>
<pre><code>##  num [1:14] 158 171 193 199 230 243 248 248 250 267 ...</code></pre>
<pre><code>##  num [1:12] 141 148 169 181 203 213 229 244 257 260 ...</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>                            <span class="co"># number of replicates</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)                        <span class="co"># pooled sample</span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)                  <span class="co"># storage for replicates</span></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>ecdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, x){</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  <span class="co"># 经验分布函数</span></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  <span class="co"># sample为对应的样本, 为向量</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  <span class="co"># x为经验分布函数的自变量, 可以为向量</span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>    res[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample <span class="sc">&lt;=</span> x[i])</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>  }</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>}</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>W_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sample1, sample2){</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>  <span class="co"># Cramer-von Mises统计量</span></span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample1); m <span class="ot">&lt;-</span> <span class="fu">length</span>(sample2)</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a>  temp1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf</span>(sample1, sample1) <span class="sc">-</span> <span class="fu">ecdf</span>(sample2, sample1))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>  temp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf</span>(sample1, sample2) <span class="sc">-</span> <span class="fu">ecdf</span>(sample2, sample2))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>  <span class="fu">return</span>(m<span class="sc">*</span>n <span class="sc">*</span> (temp1 <span class="sc">+</span> temp2)<span class="sc">/</span> (m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>}</span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a><span class="co"># Permutation test with Cramer-von Mises statistic</span></span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a>W0 <span class="ot">&lt;-</span> <span class="fu">W_2</span>(x, y)</span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(n<span class="sc">+</span>m, <span class="at">size =</span> n, <span class="at">replace =</span> F)</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">W_2</span>(x1, y1)</span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>}</span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W0, reps) <span class="sc">&gt;=</span> W0); p</span></code></pre></div>
<pre><code>## [1] 0.434</code></pre>
<p>p值表明检验不显著.</p>
<p>分析例8.2:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])) <span class="co"># x发生了改变</span></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a><span class="fu">str</span>(x); <span class="fu">str</span>(y)</span></code></pre></div>
<pre><code>##  num [1:12] 226 295 297 318 320 322 334 339 340 341 ...</code></pre>
<pre><code>##  num [1:12] 141 148 169 181 203 213 229 244 257 260 ...</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>                            <span class="co"># number of replicates</span></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)                        <span class="co"># pooled sample</span></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)                  <span class="co"># storage for replicates</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>ecdf <span class="ot">&lt;-</span> <span class="cf">function</span>(sample, x){</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>  <span class="co"># 经验分布函数</span></span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  <span class="co"># sample为对应的样本, 为向量</span></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>  <span class="co"># x为经验分布函数的自变量, 可以为向量</span></span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>    res[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample <span class="sc">&lt;=</span> x[i])</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>  }</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>}</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>W_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sample1, sample2){</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>  <span class="co"># Cramer-von Mises统计量</span></span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample1); m <span class="ot">&lt;-</span> <span class="fu">length</span>(sample2)</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  temp1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf</span>(sample1, sample1) <span class="sc">-</span> <span class="fu">ecdf</span>(sample2, sample1))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  temp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf</span>(sample1, sample2) <span class="sc">-</span> <span class="fu">ecdf</span>(sample2, sample2))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  <span class="fu">return</span>(m<span class="sc">*</span>n <span class="sc">*</span> (temp1 <span class="sc">+</span> temp2)<span class="sc">/</span> (m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>}</span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a></span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a><span class="co"># Permutation test with Cramer-von Mises statistic</span></span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a>W0 <span class="ot">&lt;-</span> <span class="fu">W_2</span>(x, y)</span>
<span id="cb83-27"><a href="#cb83-27" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb83-28"><a href="#cb83-28" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(n<span class="sc">+</span>m, <span class="at">size =</span> n, <span class="at">replace =</span> F)</span>
<span id="cb83-29"><a href="#cb83-29" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb83-30"><a href="#cb83-30" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb83-31"><a href="#cb83-31" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">W_2</span>(x1, y1)</span>
<span id="cb83-32"><a href="#cb83-32" tabindex="-1"></a>}</span>
<span id="cb83-33"><a href="#cb83-33" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W0, reps) <span class="sc">&gt;=</span> W0); p</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>p值表明检验显著.</p>
</div>
<div id="question-3-5" class="section level2">
<h2>Question 3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co"># count five statistic</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>count5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>  x_extreme <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&gt;</span> <span class="fu">max</span>(y1)) <span class="sc">+</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> <span class="fu">min</span>(y1))</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>  y_extreme <span class="ot">&lt;-</span> <span class="fu">sum</span>(y1 <span class="sc">&gt;</span> <span class="fu">max</span>(x1)) <span class="sc">+</span> <span class="fu">sum</span>(y1 <span class="sc">&lt;</span> <span class="fu">min</span>(x1))</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(x_extreme, y_extreme))</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>}</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span>       <span class="co"># repeat the test N times</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50</span>; n <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">0</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">count5</span>(x, y)</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># number pf replicates</span></span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co"># storage for relicates</span></span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co"># storage for p value in each repeated test</span></span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a></span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(m<span class="sc">+</span>n, <span class="at">size =</span> m, <span class="at">replace =</span> F)</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)[k]</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)[<span class="sc">-</span>k]</span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a>    D[j] <span class="ot">&lt;-</span> <span class="fu">count5</span>(x1, y1)</span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>  }</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a>  p[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a>}</span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a><span class="fu">round</span>(p, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1] 0.1499 0.1349 0.1439 0.1289 0.1538 0.1449 0.1139 0.1508 0.1379 0.1319
## [11] 0.1249 0.1538 0.1369 0.1508 0.1309 0.1329 0.1359 0.1239 0.1389 0.1508
## [21] 0.1329 0.1429 0.1289 0.1439 0.1538 0.1479 0.1439 0.1558 0.1349 0.1359
## [31] 0.1409 0.1339 0.1229 0.1339 0.1359 0.1369 0.1259 0.1489 0.1459 0.1489
## [41] 0.1349 0.1269 0.1399 0.1489 0.1598 0.1469 0.1449 0.1499 0.1349 0.1339</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">mean</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="section-6" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="question-1-7" class="section level2">
<h2>Question 1</h2>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0){</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="at">lambda =</span> <span class="dv">1</span>)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  </span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>  logit <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">exp</span>(a <span class="sc">+</span> b1<span class="sc">*</span>x1 <span class="sc">+</span> b2<span class="sc">*</span>x2 <span class="sc">+</span> b3<span class="sc">*</span>x3)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>    p <span class="ot">&lt;-</span> t <span class="sc">/</span> (t <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(p) <span class="sc">-</span> f0)</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>  }</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>  </span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(logit, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>, <span class="dv">30</span>))</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">unlist</span>(res)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>}</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>; b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a><span class="fu">intercept</span>(N, b1, b2, b3, f0[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>##          root        f.root          iter 
## -3.167175e+00  1.188843e-08  1.000000e+01</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">intercept</span>(N, b1, b2, b3, f0[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##          root        f.root          iter 
## -6.077767e+00 -1.138390e-07  1.400000e+01</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">intercept</span>(N, b1, b2, b3, f0[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>##          root        f.root          iter 
## -8.745344e+00  1.698565e-11  1.200000e+01</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">intercept</span>(N, b1, b2, b3, f0[<span class="dv">4</span>])</span></code></pre></div>
<pre><code>##          root        f.root          iter 
## -1.121787e+01  1.342837e-11  1.200000e+01</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.02</span>, <span class="fl">0.001</span>)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">20</span>)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">intercept</span>(N, b1, b2, b3, f0[i])[<span class="dv">1</span>]</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>}</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>neg_log_f0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(f0)</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a><span class="fu">plot</span>(neg_log_f0, a, <span class="at">main =</span> <span class="st">&#39;-log(f0) vs a&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-7" class="section level2">
<h2>Question 2</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<p>Standard Laplace: <span class="math inline">\(f(x) = \frac12e^{-\vert
x\vert},\quad x \in \mathbb{R}\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>RW_Metropolis_Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>  <span class="co"># 用random walk metropolis方法生成标准拉普拉斯随机数</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co"># 生成的随机游走链的长度</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0 <span class="co"># 用户给定初始值</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 标记拒绝的次数</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) <span class="co"># 提议分布采用正态分布，方差由用户指定</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y)))){</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>    }</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  }</span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">rej_num =</span> k, <span class="at">accept_rate =</span> (N<span class="sc">-</span>k)<span class="sc">/</span>N))</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>}</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a></span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">8</span>)</span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">RW_Metropolis_Laplace</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">RW_Metropolis_Laplace</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">RW_Metropolis_Laplace</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">RW_Metropolis_Laplace</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a></span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;sigma = 0.05: rej_num is &#39;</span>, rw1<span class="sc">$</span>rej_num, <span class="st">&#39;, accept_rate is &#39;</span>, rw1<span class="sc">$</span>accept_rate, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">sigma = 0.5 : rej_num is &#39;</span>, rw2<span class="sc">$</span>rej_num, <span class="st">&#39;, accept_rate is &#39;</span>, rw2<span class="sc">$</span>accept_rate,</span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a><span class="st">&#39;</span><span class="sc">\n</span><span class="st">sigma = 2   : rej_num is &#39;</span>, rw3<span class="sc">$</span>rej_num, <span class="st">&#39;, accept_rate is &#39;</span>, rw3<span class="sc">$</span>accept_rate,</span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a><span class="st">&#39;</span><span class="sc">\n</span><span class="st">sigma = 8   : rej_num is &#39;</span>, rw4<span class="sc">$</span>rej_num, <span class="st">&#39;, accept_rate is &#39;</span>, rw4<span class="sc">$</span>accept_rate, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<pre><code>## sigma = 0.05: rej_num is 42, accept_rate is 0.979
## sigma = 0.5 : rej_num is 336, accept_rate is 0.832
## sigma = 2   : rej_num is 974, accept_rate is 0.513
## sigma = 8   : rej_num is 1604, accept_rate is 0.198</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">:</span><span class="dv">1500</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="fu">plot</span>(index, rw1<span class="sc">$</span>x[index], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&#39;sigma = 0.05&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">plot</span>(index, rw2<span class="sc">$</span>x[index], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&#39;sigma = 0.5&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">plot</span>(index, rw3<span class="sc">$</span>x[index], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&#39;sigma = 2&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">plot</span>(index, rw4<span class="sc">$</span>x[index], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">main =</span> <span class="st">&#39;sigma = 8&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以发现当提议分布的方差增大时，拒绝率显著提高，算法效率变差。</p>
</div>
<div id="question-3-6" class="section level2">
<h2>Question 3</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_y,Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3</h2>
<p>我们用吉布斯采样生成二元正态分布随机数，各参数如题给定。</p>
<p><span class="math inline">\(\mathbb{E}(X\,\vert\,Y=y)=\mu_1+\Sigma_{12}\Sigma_{22}^{-1}(y-\mu_2)=0+0.9\times1\div1(y-0)=0.9y\)</span>,</p>
<p><span class="math inline">\(Var(X\,\vert\,Y=y)=\Sigma_{11}-\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}=(1-\rho^2)\sigma_1^2=(1-0.9^2)\times1^2=0.19\)</span>,</p>
<p>于是<span class="math inline">\(f(x\,\vert\,y) \sim
N(0.9y,\,0.19)\)</span>, <span class="math inline">\(f(y\,\vert\,x)\sim
N(0.9x,\,0.19)\)</span>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>            <span class="co"># length of chain</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">2000</span>         <span class="co"># burn-in length</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>ro <span class="ot">&lt;-</span> <span class="fl">0.9</span>                          <span class="co"># correlation</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span>; mu2 <span class="ot">&lt;-</span> <span class="dv">0</span>                 <span class="co"># mean vector</span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span>; sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span>           <span class="co"># standard deviation</span></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>cond_sigma1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>ro<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1 <span class="co"># conditional variance of x given y</span></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>cond_sigma2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>ro<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2 <span class="co"># conditional variance of y given x</span></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co"># initialize</span></span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>  cond_mu1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> ro <span class="sc">*</span> (y<span class="sc">-</span>mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2 <span class="co"># conditional mean of x given y</span></span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, cond_mu1, cond_sigma1)</span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>  cond_mu2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> ro <span class="sc">*</span> (x<span class="sc">-</span>mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1 <span class="co"># conditional mean of y given x</span></span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, cond_mu2, cond_sigma2)</span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a>}</span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a><span class="co"># plot the generated sample after discarding a burn-in period of length 2000</span></span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main =</span> <span class="st">&#39;&#39;</span>, <span class="at">cex =</span> <span class="fl">0.25</span>, <span class="at">xlab =</span> <span class="st">&#39;x&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>, <span class="at">xlim =</span> <span class="fu">range</span>(x[, <span class="dv">1</span>]), <span class="at">ylim =</span> <span class="fu">range</span>(x[, <span class="dv">2</span>]), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="co"># fit a simple linear model</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(x[, <span class="dv">2</span>]<span class="sc">~</span>x[, <span class="dv">1</span>])</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.59565 -0.28486  0.00076  0.28642  1.46339 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.008855   0.007926   1.117    0.264    
## x[, 1]      0.898140   0.008155 110.136   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.434 on 2998 degrees of freedom
## Multiple R-squared:  0.8018, Adjusted R-squared:  0.8018 
## F-statistic: 1.213e+04 on 1 and 2998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># check the residuals for normality and constant variance</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="do">##### 残差正态性良好 #####</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a><span class="do">##### 残差无非线性趋势，方差齐性良好 #####</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4-3" class="section level2">
<h2>Question 4</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>. (See Exercise 9.9.) Also
use the coda [212] package to check for convergence of the chain by the
Gelman-Rubin method. Hints: See the help topics for the coda functions
gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co"># The Rayleigh(sigma) density</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma){</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>}</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a><span class="co"># Metropolis approach to generate a chain of length n</span></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>MH_Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma){</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>  </span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="co"># y is accepted</span></span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt <span class="co"># y is rejected</span></span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>    }</span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>  }</span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a>}</span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a></span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a><span class="co"># get R_hat</span></span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a>Gelman_Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a>  </span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a>  psi_means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi_means)</span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(psi, <span class="dv">1</span>, var))</span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a>  v_hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> B<span class="sc">/</span>n</span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a>  r_hat <span class="ot">&lt;-</span> v_hat<span class="sc">/</span>W</span>
<span id="cb108-38"><a href="#cb108-38" tabindex="-1"></a>  <span class="fu">return</span>(r_hat)</span>
<span id="cb108-39"><a href="#cb108-39" tabindex="-1"></a>}</span>
<span id="cb108-40"><a href="#cb108-40" tabindex="-1"></a></span>
<span id="cb108-41"><a href="#cb108-41" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb108-42"><a href="#cb108-42" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb108-43"><a href="#cb108-43" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb108-44"><a href="#cb108-44" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb108-45"><a href="#cb108-45" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb108-46"><a href="#cb108-46" tabindex="-1"></a></span>
<span id="cb108-47"><a href="#cb108-47" tabindex="-1"></a><span class="co"># generate chains</span></span>
<span id="cb108-48"><a href="#cb108-48" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb108-49"><a href="#cb108-49" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">MH_Rayleigh</span>(N, sigma)</span>
<span id="cb108-50"><a href="#cb108-50" tabindex="-1"></a>}</span>
<span id="cb108-51"><a href="#cb108-51" tabindex="-1"></a></span>
<span id="cb108-52"><a href="#cb108-52" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb108-53"><a href="#cb108-53" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb108-54"><a href="#cb108-54" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb108-55"><a href="#cb108-55" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb108-56"><a href="#cb108-56" tabindex="-1"></a>  psi[i, ] <span class="ot">&lt;-</span> psi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb108-57"><a href="#cb108-57" tabindex="-1"></a>}</span>
<span id="cb108-58"><a href="#cb108-58" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb108-59"><a href="#cb108-59" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">Gelman_Rubin</span>(psi[, <span class="dv">1</span><span class="sc">:</span>j]), <span class="dv">3</span>)</span>
<span id="cb108-60"><a href="#cb108-60" tabindex="-1"></a>}</span>
<span id="cb108-61"><a href="#cb108-61" tabindex="-1"></a></span>
<span id="cb108-62"><a href="#cb108-62" tabindex="-1"></a><span class="co"># plot the sequence of rhat statistics to see when rhat &lt; 1.2</span></span>
<span id="cb108-63"><a href="#cb108-63" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Rhat&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb108-64"><a href="#cb108-64" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lwd =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-7" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="question-1-8" class="section level2">
<h2>Question 1</h2>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a><span class="co"># observed data log-likelihood maximization</span></span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>l_tilta <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">lambda =</span> <span class="dv">1</span>)  <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v)))</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle</span>(l_tilta)</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>fit<span class="sc">@</span>coef</span></code></pre></div>
<pre><code>##    lambda 
## 0.0719775</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># EM algorithm</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>err <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span> <span class="co"># 收敛所容忍的误差</span></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">20</span>                    <span class="co"># EM算法迭代初值</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>flag <span class="ot">&lt;-</span> <span class="dv">1</span>                       <span class="co"># 误差标记</span></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span>                       <span class="co"># 迭代次数</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>  <span class="co"># 迭代公式</span></span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u) <span class="sc">-</span> v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v)))</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>  <span class="fu">return</span>((n <span class="sc">*</span> x<span class="sc">/</span>(n <span class="sc">+</span> x <span class="sc">*</span> temp)))</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>}</span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a><span class="cf">while</span>(flag <span class="sc">&gt;</span> err){</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>  flag <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda <span class="sc">-</span> <span class="fu">f</span>(lambda))</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">f</span>(lambda)</span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a>}</span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM estimate: &quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">times of iteration: &quot;</span>, iter, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<pre><code>## EM estimate: 0.0719735
## times of iteration: 3</code></pre>
</div>
<div id="question-2-8" class="section level2">
<h2>Question 2</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute B &lt;- A + 2, find the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B.</p>
</div>
<div id="answer-2-8" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>solve_game <span class="ot">&lt;-</span> <span class="cf">function</span>(A){</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>  min_A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min_A</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>  max_A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A<span class="sc">/</span>max_A</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> T, <span class="at">n.iter =</span> it)</span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a>  </span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb113-20"><a href="#cb113-20" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb113-21"><a href="#cb113-21" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb113-22"><a href="#cb113-22" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb113-23"><a href="#cb113-23" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> F, <span class="at">n.iter =</span> it)</span>
<span id="cb113-24"><a href="#cb113-24" tabindex="-1"></a>  </span>
<span id="cb113-25"><a href="#cb113-25" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max_A <span class="sc">+</span> min_A, </span>
<span id="cb113-26"><a href="#cb113-26" tabindex="-1"></a>               <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb113-27"><a href="#cb113-27" tabindex="-1"></a>               <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb113-28"><a href="#cb113-28" tabindex="-1"></a>               <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max_A <span class="sc">+</span> min_A)</span>
<span id="cb113-29"><a href="#cb113-29" tabindex="-1"></a>  <span class="fu">return</span>(soln)</span>
<span id="cb113-30"><a href="#cb113-30" tabindex="-1"></a>}</span>
<span id="cb113-31"><a href="#cb113-31" tabindex="-1"></a></span>
<span id="cb113-32"><a href="#cb113-32" tabindex="-1"></a><span class="co"># input the payoff matrix</span></span>
<span id="cb113-33"><a href="#cb113-33" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb113-34"><a href="#cb113-34" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb113-35"><a href="#cb113-35" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb113-36"><a href="#cb113-36" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb113-37"><a href="#cb113-37" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb113-38"><a href="#cb113-38" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb113-39"><a href="#cb113-39" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb113-40"><a href="#cb113-40" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb113-41"><a href="#cb113-41" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb113-42"><a href="#cb113-42" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb113-43"><a href="#cb113-43" tabindex="-1"></a></span>
<span id="cb113-44"><a href="#cb113-44" tabindex="-1"></a><span class="co"># solve game A and game B</span></span>
<span id="cb113-45"><a href="#cb113-45" tabindex="-1"></a>s_A <span class="ot">&lt;-</span> <span class="fu">solve_game</span>(A)</span>
<span id="cb113-46"><a href="#cb113-46" tabindex="-1"></a>s_B <span class="ot">&lt;-</span> <span class="fu">solve_game</span>(B)</span>
<span id="cb113-47"><a href="#cb113-47" tabindex="-1"></a></span>
<span id="cb113-48"><a href="#cb113-48" tabindex="-1"></a><span class="co"># solution of game B</span></span>
<span id="cb113-49"><a href="#cb113-49" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s_B<span class="sc">$</span>x, s_B<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co"># value of game A and B</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>value <span class="ot">&lt;-</span> <span class="fu">c</span>(s_A<span class="sc">$</span>v, s_B<span class="sc">$</span>v)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="fu">names</span>(value) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>); <span class="fu">print</span>(value)</span></code></pre></div>
<pre><code>## A B 
## 0 2</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="co"># one of the extreme points</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">25</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>, <span class="dv">20</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>, <span class="dv">16</span><span class="sc">/</span><span class="dv">61</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 0.0000000 0.0000000 0.4098361 0.0000000 0.3278689 0.0000000 0.2622951
## [8] 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co"># 显然game B的解为game A的一个极值点. </span></span></code></pre></div>
</div>
<div id="section-8" class="section level2">
<h2>——————————————————————————–</h2>
</div>
</div>
<div id="hw10" class="section level1">
<h1>HW10</h1>
<div id="question-1-9" class="section level2">
<h2>Question 1</h2>
<ul>
<li><p>2.1.3 Ex.4</p></li>
<li><p>2.3.1 Ex.1, Ex.2</p></li>
<li><p>2.4.5 Ex.2, Ex.3</p></li>
<li><p>Page 204 Ex.2</p></li>
<li><p>Page 213 Ex.1</p></li>
</ul>
</div>
<div id="answer-1-9" class="section level2">
<h2>Answer 1</h2>
<ul>
<li>2.1.3 Ex.4</li>
</ul>
<p>list可以存储不同类型和结构的数据,
如字符型、逻辑型、数值型、矩阵、列表、数据框等,
unlist()可以智能地将它们转化为尽可能统一的类型存储在向量中,
as.vector()不可以.</p>
<ul>
<li>2.3.1 Ex.1, Ex.2</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="co"># Ex.1</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a><span class="fu">dim</span>(v)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="co"># Ex.2</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<ul>
<li>2.4.5 Ex.2, Ex.3</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="co"># Ex.2</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>), <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="fu">c</span>(T,T,F), <span class="st">&#39;4&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>##   X1 X2    X3 X4
## 1  1  a  TRUE NA
## 2  2  b  TRUE NA
## 3  3  c FALSE NA</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">as.matrix</span>(d)</span></code></pre></div>
<pre><code>##      X1  X2  X3      X4
## [1,] &quot;1&quot; &quot;a&quot; &quot;TRUE&quot;  NA
## [2,] &quot;2&quot; &quot;b&quot; &quot;TRUE&quot;  NA
## [3,] &quot;3&quot; &quot;c&quot; &quot;FALSE&quot; NA</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co"># Ex.3</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>d_nocol <span class="ot">&lt;-</span> d[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>d_nocol</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">str</span>(d_nocol)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  0 variables</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>d_norow <span class="ot">&lt;-</span> d[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), ]</span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>d_norow</span></code></pre></div>
<pre><code>## [1] X1 X2 X3 X4
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">str</span>(d_norow)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  4 variables:
##  $ X1: num 
##  $ X2: chr 
##  $ X3: logi 
##  $ X4: logi</code></pre>
<ul>
<li>Page 204 Ex.2</li>
</ul>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>}</span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a><span class="co"># apply scale01 to every column of a data frame</span></span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>))</span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>d1</span></code></pre></div>
<pre><code>##   X1 X2 X3
## 1  2  4  5
## 2  1  1  6
## 3  3  6  9</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">apply</span>(d1, <span class="at">MARGIN =</span> <span class="dv">2</span>, scale01)</span></code></pre></div>
<pre><code>##       X1  X2   X3
## [1,] 0.5 0.6 0.00
## [2,] 0.0 0.0 0.25
## [3,] 1.0 1.0 1.00</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="co"># apply scale01 to every numeric column of a data frame</span></span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>))</span>
<span id="cb142-3"><a href="#cb142-3" tabindex="-1"></a>d2</span></code></pre></div>
<pre><code>##   X1 X2 X3
## 1  2  4  a
## 2  1  1  b
## 3  3  6  c</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(<span class="fu">apply</span>(d2[, <span class="fu">as.logical</span>(<span class="fu">vapply</span>(d2, is.numeric, <span class="dv">2</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, scale01)), d2[, <span class="sc">!</span><span class="fu">as.logical</span>(<span class="fu">vapply</span>(d2, is.numeric, <span class="dv">2</span>)), <span class="at">drop =</span> F])</span></code></pre></div>
<pre><code>##    X1  X2 X3
## 1 0.5 0.6  a
## 2 0.0 0.0  b
## 3 1.0 1.0  c</code></pre>
<ul>
<li>Page 213 Ex.1</li>
</ul>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># Compute the standard deviation of every column in a numeric data frame.</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>))</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>d1</span></code></pre></div>
<pre><code>##   X1 X2 X3
## 1  2  4  5
## 2  1  1  6
## 3  3  6  9</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">vapply</span>(d1, sd, <span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##       X1       X2       X3 
## 1.000000 2.516611 2.081666</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="co"># Compute the standard deviation of every numeric column in a mixed data frame. </span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;1&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">&#39;2&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>), <span class="st">&#39;3&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>))</span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a>d2</span></code></pre></div>
<pre><code>##   X1 X2 X3
## 1  2  4  a
## 2  1  1  b
## 3  3  6  c</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="fu">vapply</span>(d2[, <span class="fu">as.logical</span>(<span class="fu">vapply</span>(d2, is.numeric, <span class="dv">1</span>))], sd, <span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##       X1       X2 
## 1.000000 2.516611</code></pre>
</div>
<div id="question-2-9" class="section level2">
<h2>Question 2</h2>
<p>Consider the bivariate density <span class="math display">\[f(x,y)
\propto C_n^x\,y^{x+a-1}(1-y)^{n-x+b-1},\quad\quad
x=0,\,1,\,\dots,\,n,\;y \in [0,\,1].\]</span> For fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
<span class="math inline">\(B(n,y)\)</span> and <span class="math inline">\(Beta(x+a,n-x+b)\)</span>. Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
</div>
<div id="answer-2-9" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="co"># settings</span></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>Nchain <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb154-6"><a href="#cb154-6" tabindex="-1"></a>thin<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb154-7"><a href="#cb154-7" tabindex="-1"></a></span>
<span id="cb154-8"><a href="#cb154-8" tabindex="-1"></a><span class="co"># gibbs in R</span></span>
<span id="cb154-9"><a href="#cb154-9" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin) {</span>
<span id="cb154-10"><a href="#cb154-10" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb154-11"><a href="#cb154-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb154-12"><a href="#cb154-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb154-13"><a href="#cb154-13" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb154-14"><a href="#cb154-14" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb154-15"><a href="#cb154-15" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb154-16"><a href="#cb154-16" tabindex="-1"></a>    }</span>
<span id="cb154-17"><a href="#cb154-17" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb154-18"><a href="#cb154-18" tabindex="-1"></a>  }</span>
<span id="cb154-19"><a href="#cb154-19" tabindex="-1"></a>  mat</span>
<span id="cb154-20"><a href="#cb154-20" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
